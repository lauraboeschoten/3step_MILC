setwd("F:/datapackage_threestepMILC/simulationstudy/12_scan_BCH")

require(brew)                                                                   # load brew package
require(plyr)                                                                   # load plyr package

options(scipen=999)                                                             # scientific notation off

nsim  <- 1000                                                                   # number of simulations
nboot <- 5                                                                      # number of bootstrap samples
ncomb <- 32                                                                     # number of possible combinations of scores                
nvar  <- 5                                                                      # number of variables


scens <- list(ss     =c(200, 500, 1000),                                        # all simulation conditions
              c.prob =c(0.70, 0.80, 0.90, 0.95, 0.99),
              z.coef =c(0.01, 0.05, 0.10, 0.20),
              q.coef =c(0.5, 0.6224593, 0.7310586, 0.8807971))


scen.mat <- expand.grid(scens) 
useful   <- matrix(NA, nrow(scen.mat), 1)                                       # matrix to store results for every scenario

scen.mat <- cbind(scen.mat, useful)                                             # combine with scenario info

for (i in 1:nrow(scen.mat)){
  negativeboot <- read.table(paste0("F:/datapackage_threestepMILC/simulationstudy/12_scan_BCH/",
                              scen.mat[i,1],"_",                                # load information with number of 
                              substring(scen.mat[i,2], 3),"_",                  # inadmissable solutions
                              substring(scen.mat[i,3], 3),"_",
                              substring(scen.mat[i,4], 3),
                              "negativeboot.txt"), header=T)
  scen.mat[i,5] <- as.numeric(table(negativeboot)[1])                           # turn to numeric
}

#ss c.prob z.coef    q.coef useful
#1    200   0.70   0.01 0.5000000    210
#2    500   0.70   0.01 0.5000000    275
#3   1000   0.70   0.01 0.5000000    389
#4    200   0.80   0.01 0.5000000    411
#5    500   0.80   0.01 0.5000000    866
#6   1000   0.80   0.01 0.5000000    992
#7    200   0.90   0.01 0.5000000    388
#8    500   0.90   0.01 0.5000000    849
#9   1000   0.90   0.01 0.5000000    986
#10   200   0.95   0.01 0.5000000    403
#11   500   0.95   0.01 0.5000000    847
#12  1000   0.95   0.01 0.5000000    984
#13   200   0.99   0.01 0.5000000    387
#14   500   0.99   0.01 0.5000000    837
#15  1000   0.99   0.01 0.5000000    980
#16   200   0.70   0.05 0.5000000    710
#17   500   0.70   0.05 0.5000000    799
#18  1000   0.70   0.05 0.5000000    925
#19   200   0.80   0.05 0.5000000    979
#20   500   0.80   0.05 0.5000000   1000
#21  1000   0.80   0.05 0.5000000   1000
#22   200   0.90   0.05 0.5000000    990
#23   500   0.90   0.05 0.5000000   1000
#24  1000   0.90   0.05 0.5000000   1000
#25   200   0.95   0.05 0.5000000    986
#26   500   0.95   0.05 0.5000000   1000
#27  1000   0.95   0.05 0.5000000   1000
#28   200   0.99   0.05 0.5000000    986
#29   500   0.99   0.05 0.5000000   1000
#30  1000   0.99   0.05 0.5000000   1000
#31   200   0.70   0.10 0.5000000    954
#32   500   0.70   0.10 0.5000000    992
#33  1000   0.70   0.10 0.5000000   1000
#34   200   0.80   0.10 0.5000000   1000
#35   500   0.80   0.10 0.5000000   1000
#36  1000   0.80   0.10 0.5000000   1000
#37   200   0.90   0.10 0.5000000   1000
#38   500   0.90   0.10 0.5000000   1000
#39  1000   0.90   0.10 0.5000000   1000
#40   200   0.95   0.10 0.5000000   1000
#41   500   0.95   0.10 0.5000000   1000
#42  1000   0.95   0.10 0.5000000   1000
#43   200   0.99   0.10 0.5000000   1000
#44   500   0.99   0.10 0.5000000   1000
#45  1000   0.99   0.10 0.5000000   1000
#46   200   0.70   0.20 0.5000000   1000
#47   500   0.70   0.20 0.5000000   1000
#48  1000   0.70   0.20 0.5000000   1000
#49   200   0.80   0.20 0.5000000   1000
#50   500   0.80   0.20 0.5000000   1000
#51  1000   0.80   0.20 0.5000000   1000
#52   200   0.90   0.20 0.5000000   1000
#53   500   0.90   0.20 0.5000000   1000
#54  1000   0.90   0.20 0.5000000   1000
#55   200   0.95   0.20 0.5000000   1000
#56   500   0.95   0.20 0.5000000   1000
#57  1000   0.95   0.20 0.5000000   1000
#58   200   0.99   0.20 0.5000000   1000
#59   500   0.99   0.20 0.5000000   1000
#60  1000   0.99   0.20 0.5000000   1000
#61   200   0.70   0.01 0.6224593    212
#62   500   0.70   0.01 0.6224593    276
#63  1000   0.70   0.01 0.6224593    359
#64   200   0.80   0.01 0.6224593    400
#65   500   0.80   0.01 0.6224593    852
#66  1000   0.80   0.01 0.6224593    980
#67   200   0.90   0.01 0.6224593    396
#68   500   0.90   0.01 0.6224593    815
#69  1000   0.90   0.01 0.6224593    981
#70   200   0.95   0.01 0.6224593    374
#71   500   0.95   0.01 0.6224593    815
#72  1000   0.95   0.01 0.6224593    966
#73   200   0.99   0.01 0.6224593    374
#74   500   0.99   0.01 0.6224593    792
#75  1000   0.99   0.01 0.6224593    975
#76   200   0.70   0.05 0.6224593    694
#77   500   0.70   0.05 0.6224593    742
#78  1000   0.70   0.05 0.6224593    883
#79   200   0.80   0.05 0.6224593    971
#80   500   0.80   0.05 0.6224593   1000
#81  1000   0.80   0.05 0.6224593   1000
#82   200   0.90   0.05 0.6224593    982
#83   500   0.90   0.05 0.6224593   1000
#84  1000   0.90   0.05 0.6224593   1000
#85   200   0.95   0.05 0.6224593    977
#86   500   0.95   0.05 0.6224593    999
#87  1000   0.95   0.05 0.6224593   1000
#88   200   0.99   0.05 0.6224593    981
#89   500   0.99   0.05 0.6224593   1000
#90  1000   0.99   0.05 0.6224593   1000
#91   200   0.70   0.10 0.6224593    939
#92   500   0.70   0.10 0.6224593    989
#93  1000   0.70   0.10 0.6224593    998
#94   200   0.80   0.10 0.6224593   1000
#95   500   0.80   0.10 0.6224593   1000
#96  1000   0.80   0.10 0.6224593   1000
#97   200   0.90   0.10 0.6224593    998
#98   500   0.90   0.10 0.6224593   1000
#99  1000   0.90   0.10 0.6224593   1000
#100  200   0.95   0.10 0.6224593    998
#101  500   0.95   0.10 0.6224593   1000
#102 1000   0.95   0.10 0.6224593   1000
#103  200   0.99   0.10 0.6224593    999
#104  500   0.99   0.10 0.6224593   1000
#105 1000   0.99   0.10 0.6224593   1000
#106  200   0.70   0.20 0.6224593   1000
#107  500   0.70   0.20 0.6224593   1000
#108 1000   0.70   0.20 0.6224593   1000
#109  200   0.80   0.20 0.6224593   1000
#110  500   0.80   0.20 0.6224593   1000
#111 1000   0.80   0.20 0.6224593   1000
#112  200   0.90   0.20 0.6224593   1000
#113  500   0.90   0.20 0.6224593   1000
#114 1000   0.90   0.20 0.6224593   1000
#115  200   0.95   0.20 0.6224593   1000
#116  500   0.95   0.20 0.6224593   1000
#117 1000   0.95   0.20 0.6224593   1000
#118  200   0.99   0.20 0.6224593   1000
#119  500   0.99   0.20 0.6224593   1000
#120 1000   0.99   0.20 0.6224593   1000
#121  200   0.70   0.01 0.7310586    160
#122  500   0.70   0.01 0.7310586    226
#123 1000   0.70   0.01 0.7310586    265
#124  200   0.80   0.01 0.7310586    365
#125  500   0.80   0.01 0.7310586    769
#126 1000   0.80   0.01 0.7310586    950
#127  200   0.90   0.01 0.7310586    347
#128  500   0.90   0.01 0.7310586    727
#129 1000   0.90   0.01 0.7310586    926
#130  200   0.95   0.01 0.7310586    320
#131  500   0.95   0.01 0.7310586    704
#132 1000   0.95   0.01 0.7310586    929
#133  200   0.99   0.01 0.7310586    327
#134  500   0.99   0.01 0.7310586    724
#135 1000   0.99   0.01 0.7310586    933
#136  200   0.70   0.05 0.7310586    615
#137  500   0.70   0.05 0.7310586    615
#138 1000   0.70   0.05 0.7310586    760
#139  200   0.80   0.05 0.7310586    953
#140  500   0.80   0.05 0.7310586    999
#141 1000   0.80   0.05 0.7310586   1000
#142  200   0.90   0.05 0.7310586    929
#143  500   0.90   0.05 0.7310586    998
#144 1000   0.90   0.05 0.7310586   1000
#145  200   0.95   0.05 0.7310586    945
#146  500   0.95   0.05 0.7310586    999
#147 1000   0.95   0.05 0.7310586   1000
#148  200   0.99   0.05 0.7310586    944
#149  500   0.99   0.05 0.7310586   1000
#150 1000   0.99   0.05 0.7310586   1000
#151  200   0.70   0.10 0.7310586    878
#152  500   0.70   0.10 0.7310586    943
#153 1000   0.70   0.10 0.7310586    989
#154  200   0.80   0.10 0.7310586    995
#155  500   0.80   0.10 0.7310586   1000
#156 1000   0.80   0.10 0.7310586   1000
#157  200   0.90   0.10 0.7310586    996
#158  500   0.90   0.10 0.7310586   1000
#159 1000   0.90   0.10 0.7310586   1000
#160  200   0.95   0.10 0.7310586    994
#161  500   0.95   0.10 0.7310586   1000
#162 1000   0.95   0.10 0.7310586   1000
#163  200   0.99   0.10 0.7310586    996
#164  500   0.99   0.10 0.7310586   1000
#165 1000   0.99   0.10 0.7310586   1000
#166  200   0.70   0.20 0.7310586    998
#167  500   0.70   0.20 0.7310586   1000
#168 1000   0.70   0.20 0.7310586   1000
#169  200   0.80   0.20 0.7310586   1000
#170  500   0.80   0.20 0.7310586   1000
#171 1000   0.80   0.20 0.7310586   1000
#172  200   0.90   0.20 0.7310586   1000
#173  500   0.90   0.20 0.7310586   1000
#174 1000   0.90   0.20 0.7310586   1000
#175  200   0.95   0.20 0.7310586   1000
#176  500   0.95   0.20 0.7310586   1000
#177 1000   0.95   0.20 0.7310586   1000
#178  200   0.99   0.20 0.7310586   1000
#179  500   0.99   0.20 0.7310586   1000
#180 1000   0.99   0.20 0.7310586   1000
#181  200   0.70   0.01 0.8807971    104
#182  500   0.70   0.01 0.8807971    102
#183 1000   0.70   0.01 0.8807971    105
#184  200   0.80   0.01 0.8807971    176
#185  500   0.80   0.01 0.8807971    502
#186 1000   0.80   0.01 0.8807971    730
#187  200   0.90   0.01 0.8807971    200
#188  500   0.90   0.01 0.8807971    484
#189 1000   0.90   0.01 0.8807971    719
#190  200   0.95   0.01 0.8807971    174
#191  500   0.95   0.01 0.8807971    438
#192 1000   0.95   0.01 0.8807971    702
#193  200   0.99   0.01 0.8807971    185
#194  500   0.99   0.01 0.8807971    423
#195 1000   0.99   0.01 0.8807971    691
#196  200   0.70   0.05 0.8807971    399
#197  500   0.70   0.05 0.8807971    366
#198 1000   0.70   0.05 0.8807971    449
#199  200   0.80   0.05 0.8807971    685
#200  500   0.80   0.05 0.8807971    936
#201 1000   0.80   0.05 0.8807971    994
#202  200   0.90   0.05 0.8807971    726
#203  500   0.90   0.05 0.8807971    954
#204 1000   0.90   0.05 0.8807971    998
#205  200   0.95   0.05 0.8807971    715
#206  500   0.95   0.05 0.8807971    958
#207 1000   0.95   0.05 0.8807971    999
#208  200   0.99   0.05 0.8807971    689
#209  500   0.99   0.05 0.8807971    947
#210 1000   0.99   0.05 0.8807971    999
#211  200   0.70   0.10 0.8807971    625
#212  500   0.70   0.10 0.8807971    644
#213 1000   0.70   0.10 0.8807971    782
#214  200   0.80   0.10 0.8807971    904
#215  500   0.80   0.10 0.8807971    994
#216 1000   0.80   0.10 0.8807971   1000
#217  200   0.90   0.10 0.8807971    932
#218  500   0.90   0.10 0.8807971    999
#219 1000   0.90   0.10 0.8807971   1000
#220  200   0.95   0.10 0.8807971    918
#221  500   0.95   0.10 0.8807971    997
#222 1000   0.95   0.10 0.8807971   1000
#223  200   0.99   0.10 0.8807971    910
#224  500   0.99   0.10 0.8807971    999
#225 1000   0.99   0.10 0.8807971   1000
#226  200   0.70   0.20 0.8807971    910
#227  500   0.70   0.20 0.8807971    946
#228 1000   0.70   0.20 0.8807971    973
#229  200   0.80   0.20 0.8807971    979
#230  500   0.80   0.20 0.8807971   1000
#231 1000   0.80   0.20 0.8807971   1000
#232  200   0.90   0.20 0.8807971    994
#233  500   0.90   0.20 0.8807971   1000
#234 1000   0.90   0.20 0.8807971   1000
#235  200   0.95   0.20 0.8807971    996
#236  500   0.95   0.20 0.8807971   1000
#237 1000   0.95   0.20 0.8807971   1000
#238  200   0.99   0.20 0.8807971    992
#239  500   0.99   0.20 0.8807971   1000
#240 1000   0.99   0.20 0.8807971   1000